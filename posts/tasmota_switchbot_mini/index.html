<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.38ccdf5c998a71d2ad889faefccbe9132577d265b25e73d94a1be540ebcaaa18.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">runestone - SwitchBot Mini Smart Plugs with Tasmota &#43; Home Assistant</title>
<meta property="og:title" content=runestone&#32;-&#32;SwitchBot&#32;Mini&#32;Smart&#32;Plugs&#32;with&#32;Tasmota&#32;&#43;&#32;Home&#32;Assistant />
<meta name="twitter:title" content=runestone&#32;-&#32;SwitchBot&#32;Mini&#32;Smart&#32;Plugs&#32;with&#32;Tasmota&#32;&#43;&#32;Home&#32;Assistant />
<meta itemprop="name" content=runestone&#32;-&#32;SwitchBot&#32;Mini&#32;Smart&#32;Plugs&#32;with&#32;Tasmota&#32;&#43;&#32;Home&#32;Assistant />
<meta name="application-name" content=runestone&#32;-&#32;SwitchBot&#32;Mini&#32;Smart&#32;Plugs&#32;with&#32;Tasmota&#32;&#43;&#32;Home&#32;Assistant />
<meta property="og:site_name" content="" />


<meta name="description" content="Comprehensive guide to flashing Tasmota on smart plugs and adding them to Home Assistant" />
<meta itemprop="description" content="Comprehensive guide to flashing Tasmota on smart plugs and adding them to Home Assistant" />
<meta property="og:description" content="Comprehensive guide to flashing Tasmota on smart plugs and adding them to Home Assistant" />
<meta name="twitter:description" content="Comprehensive guide to flashing Tasmota on smart plugs and adding them to Home Assistant" />


<base href="/posts/tasmota_switchbot_mini/" />
<link rel="canonical" href="/posts/tasmota_switchbot_mini/" itemprop="url" />
<meta name="url" content="/posts/tasmota_switchbot_mini/" />
<meta name="twitter:url" content="/posts/tasmota_switchbot_mini/" />
<meta property="og:url" content="/posts/tasmota_switchbot_mini/" />


<meta property="og:updated_time" content="2023-03-22T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.92.2" />


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.a4ce1ced99e5a4daa43d82d7b006514e6399225773110b27f4746ffa5622cd5c.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="/">
                <img src="/images/raven01_main.png" alt="brand image">
            </a>
        
        
            <a href="/">
                <h1>runestone</h1>
            </a>
        
    </h1>
    <p class="lead">
    decoding technology
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="/posts/tasmota_switchbot_mini/">SwitchBot Mini Smart Plugs with Tasmota &#43; Home Assistant</a>
                            </li>
                        
                    
                
            
            
                
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/blackfeather9">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>















    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto://blackfeather@runestone.tech">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>


        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="/posts/tasmota_switchbot_mini/">SwitchBot Mini Smart Plugs with Tasmota &#43; Home Assistant</a>
  </h1>

  <div class="headline">
    <div>
      
      <time datetime=" 2023-03-22T00:00:00Z" class="post-date">
        March 22, 2023
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>7 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-smart home">
        <a href="/tags/smart-home">smart home</a>
      </li>
      
      <li class="tag-diy">
        <a href="/tags/diy">diy</a>
      </li>
      
      <li class="tag-home assistant">
        <a href="/tags/home-assistant">home assistant</a>
      </li>
      
      <li class="tag-linux">
        <a href="/tags/linux">linux</a>
      </li>
      
      <li class="tag-tasmota">
        <a href="/tags/tasmota">tasmota</a>
      </li>
      
    </ul>
    
  </div>

  
  
  <p class="seriesname">
    Series: <a href="/series/home-assistant">home assistant</a>
  </p>
  

  
</div>

  <p>The Switchbot Mini is an ESP32-based smart plug, and comes in affordable 4-packs. It can be flashed over the air and requires no disassembly. In this tutorial we will be flashing the devices with Tasmota firmware, then adding to Home Assistant for control and power monitoring.</p>
<blockquote>
<p>📝 <strong>Note:</strong> This tutorial assumes you already have a working Home Assistant server with the Tasmota integration and an MQTT broker installed like Mosquitto. We will have a guide for this soon too.</p>
</blockquote>
<p>We are not sponsored or endorsed by SwitchBot. We chose the W1901400 because it&rsquo;s one of the most affordable options that supports open source firmware and OTA flashing.</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>Switchbot Mini Plugs (W1901400 or W1901401)</li>
<li>Kill A Watt P4400 or similar</li>
<li>Home Assistant with Tamsota integration and MQTT broker</li>
<li>Ability to add custom network-wide DNS entries (This guide will use Pi-Hole)</li>
<li>Android or iOS phone to use the SwitchBot app during setup.</li>
<li>Linux device to run the switchbOTA web server hack.</li>
</ul>
<h2 id="procedures">Procedures:</h2>
<h3 id="initialize-switchbot-plug">Initialize SwitchBot Plug:</h3>
<blockquote>
<p>📝 <strong>Note:</strong> We recommend using an isolated IoT network for smarthome devices whenever possible.</p>
</blockquote>
<ol>
<li>Plug in the SwitchBot Mini to a nearby outlet. Don&rsquo;t press the power button on the SwitchBot yet.</li>
<li>Install the SwitchBot app on your phone. You only need it for initial setup. <a href="https://play.google.com/store/apps/details?id=com.theswitchbot.switchbot" target="_blank">Google Play</a> or <a href="https://apps.apple.com/us/app/switchbot/id1087374760" target="_blank">App Store</a>.</li>
<li>Create a <a href="https://us.switch-bot.com/pages/register-account" target="_blank">SwitchBot Cloud account</a>. We recommend using a disposable email address for this. You only need it to initialize new devices.</li>
<li>Open the app. Enable Bluetooth. Login to your Switchbot account under <code>Profile &gt; Manage Homes</code>.</li>
<li>Open the app and select <code>Add a Device</code>. Choose Plug Mini and follow the instructions. <a href="https://support.switch-bot.com/hc/en-us/articles/5265364254871-How-to-Set-Up-SwitchBot-Plug-Mini" target="_blank">SwitchBot Guide</a>.</li>
<li>Access the plug in the app. Deny the firmware upgrade. Confirm you&rsquo;re on v1.4 by clicking the Gear, then selecting <code>Firmware Version</code>. Turn the plug on and off using the app to confirm functionality.</li>
</ol>
<blockquote>
<p>📝 <strong>Note:</strong> We have used switchbOTA on stock firmware 1.3 and 1.4. It may work on newer versions, but don&rsquo;t update it if you don&rsquo;t have to.</p>
</blockquote>
<h3 id="setup-switchbota-web-server">Setup SwitchbOTA Web Server:</h3>
<p>The switchbOTA web server will spoof update requests and force the smart plug to install Tasmota firmware.</p>
<p>You will need a Linux device for this step. You can use your workstation or a VM/server. In our example, we will use a Raspberry Pi 4B running Ubuntu 20.04. <strong>This tutorial assumes you have SSH/shell access and sudo permissions</strong></p>
<ol>
<li>Login to the Linux device with SSH or the shell.</li>
<li>Follow the official <a href="https://github.com/nodesource/distributions" target="_blank">NodeSource guide</a> to enable the Node.js repository for your distro.</li>
<li>Install Node.js binary and git: <code>sudo apt-get update &amp;&amp; sudo apt-get install nodejs git -y</code></li>
<li>Run <code>npm --version</code> to confirm it&rsquo;s active.</li>
<li>Create your project directory, and enter it.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir -p /home/ubuntu/projects/ <span style="color:#f92672">&amp;&amp;</span> cd $_
</code></pre></div><ol start="5">
<li>Clone switchbOTA from Github, enter it.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git clone https://github.com/kendallgoto/switchbota/
cd switchbota/
</code></pre></div><ol start="6">
<li>Download the firmware binary.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">wget https://github.com/kendallgoto/switchbota/releases/download/v1.1/app.bin
</code></pre></div><ol start="7">
<li>Change directory, run the web server.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cd server/
npm i
sudo node index.js
</code></pre></div><h3 id="configure-dns">Configure DNS:</h3>
<p>We will now need to create an internal DNS entry that will redirect traffic from the real SwitchBot update server to our switchbOTA server so it can receive the Tasmota package.</p>
<blockquote>
<p>📝 <strong>Note:</strong> We will use Pi-hole in this example, which is controlling DNS for our wifi. You may need to do this in your firewall or router. Setting up a DNS server is beyond the scope of this guide.</p>
</blockquote>
<ol>
<li>Login to Pi-hole and click on <code>Local DNS &gt; DNS Records</code> in the sidebar.</li>
</ol>
<p><img src="images/pihole_01.png" alt="pihole example 1"></p>
<ol start="2">
<li>Add DNS records for the 3 <code>wohand.com</code> domains, which is the update server for SwitchBot. Point each of them at the IP address of your Linux box running the Node.js web server</li>
</ol>
<blockquote>
<p>📝 Note: If you don&rsquo;t know your web server IP, login to its shell, run <code>ip a</code> and look for the relevant adapter such as <code>eth0</code> or <code>wlan0</code>.</p>
</blockquote>
<pre tabindex="0"><code>a.wohand.com
wohand.com
www.wohand.com
</code></pre><p><img src="images/pihole_02.png" alt="pihole example 2"></p>
<p><img src="images/pihole_03.png" alt="pihole example 3"></p>
<h3 id="flash-tasmota">Flash Tasmota:</h3>
<blockquote>
<p>🔥 <strong>Note:</strong> It is possible to brick your smart plug if the OTA update is interrupted. Keep this in mind and proceed with caution!</p>
</blockquote>
<p>Now that we have the web server running, it will serve the Tasmota firmware when it receives an update request.</p>
<ol>
<li>Open the SwitchBot app and find your plug.</li>
<li>Click on the gear, then on <code>Firmware Version</code> and then <code>Firmware Upgrade</code> to download and install Tasmota.</li>
<li>Watch the terminal on your Linux server while the SwitchBot plug installs the payload:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ubuntu@rpi:~/projects/switchbota/server$ sudo node index.js 
Server listening on port <span style="color:#ae81ff">80</span>
::ffff:192.168.1.10 - /version/wocaotech/firmware/WoPlugUS/WoPlugUS_V15.bin
::ffff:192.168.1.10 - /payload.bin
</code></pre></div><hr>
<p>Wait a few minutes for flashing to complete. At this point the device will reboot and one of two things can happen:</p>
<ul>
<li>You can browse to the IP address of the SwitchBot plug and configure Tasmota (i.e. http://192.168.1.10:80)</li>
<li>The plug will appear dead and won&rsquo;t respond on the network.</li>
</ul>
<p>All the times we have flashed these, we have experienced option 2. Don&rsquo;t worry! This most likely means the device lost its wifi configuration, and instead is broadcasting its own SSID for initial setup.</p>
<ol>
<li>Using your phone or laptop, check for nearby networks. You may see an open network with a name like <code>tasmota-B3CFD8-4056</code>or <code>switchbota</code></li>
<li>Join the network. It will take you to a captive portal page in the browser. Now you can join the plug back to your wifi and begin setup.</li>
<li>When you successfully join it to the wifi, it will show you the new IP address, stop broadcasting its own SSID, and you can proceed with the next steps.</li>
</ol>
<blockquote>
<p>📝 <strong>Note:</strong> The on/off light doesn&rsquo;t work until after updating Tasmota. If there is no fallback wifi even after unplugging and plugging it back in, and you think the device is bricked, you may be able to recover it by taking it apart and programming it manually. See the <a href="https://templates.blakadder.com/switchbot_plugmini_W1901400.html" target="_blank">Tasmota page</a> for instructions.</p>
</blockquote>
<p>Once your device is flashed, feel free to delete it from the SwitchBot app. You can no longer use this app to communicate with it.</p>
<h3 id="configure-tasmota">Configure Tasmota</h3>
<ol>
<li>Browse to your newly flashed plug. You must use http or specify port 80 if your browser tries to do https redirection automatically.</li>
</ol>
<p><img src="images/tasmota_01.png" alt="tasmota example 1"></p>
<ol start="2">
<li>Click on <code>Configuration &gt; Configure Other</code>. Overwite the Template field with the one found <a href="https://templates.blakadder.com/switchbot_plugmini_W1901400.html" target="_blank">here</a> under <code>Configuration for ESP32-C3</code>. This will begin with <code>{&quot;NAME&quot;:&quot;W1901400&quot;,&quot;GPIO&quot;:</code>. Check Activate.</li>
<li>Change any other fields as desired, such as <code>Device Name</code> or enabling a web admin password, then click save. The device will now reboot.</li>
</ol>
<blockquote>
<p>📝 <strong>Note:</strong> We recommend enabling a web admin password. This will prompt you for authentication when accessing the configuration page. The username is <code>admin</code> and it will use the password you set.</p>
</blockquote>
<ol start="4">
<li>When the page reloads, try the <code>Toggle</code> button. You should hear the switch click and the LED will change. Try attaching a load like a lamp and it will turn the lamp on and off.</li>
</ol>
<h3 id="power-calibration">Power Calibration</h3>
<p>Out of the box, the newly-flashed plug will be wildly inaccurate. For example, ours was configured for 173v rather than 120v, so all readings will be way off. To fix this, please follow <a href="https://tasmota.github.io/docs/Power-Monitoring-Calibration/" target="_blank">the power calibration guide</a> from Tasmota. We used a <code>Kill A Watt P4400</code> and a halogen lamp for load testing on ours.</p>
<h3 id="add-to-home-assistant">Add to Home Assistant</h3>
<p>Congratulations! Your SwitchBot plug now has open source firmware and doesn&rsquo;t phone home to the cloud. You can control the on/off switch using the Tasmota landing page. Let&rsquo;s add it to Home Assistant for ease of use and monitoring!</p>
<ol>
<li>Login to the Tasmota web admin for the SwitchBot plug.</li>
<li>Navigate to <code>Configuration &gt; Configure MQTT</code></li>
</ol>
<p><img src="images/tasmota_05.png" alt="tasmota example 2"></p>
<ol start="3">
<li>In the <code>Host</code> field, enter the IP address of your Home Assistant server running an MQTT broker.</li>
<li>Configure the other settings if needed, such as MQTT TLS or passwords. For autodiscovery, we have a <code>tasmota</code> user in HA, and the smart plugs login with this username/password combo.
<a href=""></a></li>
<li>Press Save. The device will restart.</li>
<li>Open Home assistant. Go to <code>Settings &gt; Devices and Services &gt; Tasmota</code>. Click on the device count and locate your device, then configure your dashboards as desired.</li>
</ol>
<p><img src="images/tasmota_04.png" alt="tasmota example 3"></p>
<h2 id="final-words">Final Words</h2>
<p>The initial setup / first run of this tutorial can be <em>daunting</em>, especially if you&rsquo;re new to any of this. It can take several hours of trial and error to get everything working as desired.</p>
<p>That said, once you have the initial tools setup and you&rsquo;re more comfortable with OTA flashing, configuring a new plug and importing into HA can be a quick process. It takes us less than 15 minutes per plug from initializing to the plug showing up in HA at the end of the process.</p>
<h2 id="references--resources">References &amp; Resources:</h2>
<ul>
<li><a href="https://www.home-assistant.io/integrations/tasmota/" target="_blank">https://www.home-assistant.io/integrations/tasmota/</a></li>
<li><a href="https://us.switch-bot.com/products/switchbot-plug-mini" target="_blank">https://us.switch-bot.com/products/switchbot-plug-mini</a></li>
<li><a href="https://github.com/kendallgoto/switchbota/" target="_blank">https://github.com/kendallgoto/switchbota/</a></li>
<li><a href="https://templates.blakadder.com/switchbot_plugmini_W1901400.html" target="_blank">https://templates.blakadder.com/switchbot_plugmini_W1901400.html</a></li>
<li><a href="https://en.wikipedia.org/wiki/Kill_A_Watt" target="_blank">https://en.wikipedia.org/wiki/Kill_A_Watt</a></li>
<li><a href="https://community.home-assistant.io/t/using-switchbot-mini-plug-with-tasmota32-and-mqtt-as-ble-gateway-for-xiaomi-lywsd03mmc-temp-sensors/455287" target="_blank">https://community.home-assistant.io/t/using-switchbot-mini-plug-with-tasmota32-and-mqtt-as-ble-gateway-for-xiaomi-lywsd03mmc-temp-sensors/455287</a></li>
<li><a href="https://support.switch-bot.com/hc/en-us/articles/5265364254871-How-to-Set-Up-SwitchBot-Plug-Mini" target="_blank">https://support.switch-bot.com/hc/en-us/articles/5265364254871-How-to-Set-Up-SwitchBot-Plug-Mini</a></li>
<li><a href="https://apps.apple.com/us/app/switchbot/id1087374760" target="_blank">https://apps.apple.com/us/app/switchbot/id1087374760</a></li>
<li><a href="https://play.google.com/store/apps/details?id=com.theswitchbot.switchbot" target="_blank">https://play.google.com/store/apps/details?id=com.theswitchbot.switchbot</a></li>
<li><a href="https://us.switch-bot.com/pages/register-account" target="_blank">https://us.switch-bot.com/pages/register-account</a></li>
<li><a href="https://github.com/nodesource/distributions/blob/master/README.md" target="_blank">https://github.com/nodesource/distributions/blob/master/README.md</a></li>
<li><a href="https://tasmota.github.io/docs/Power-Monitoring-Calibration/" target="_blank">https://tasmota.github.io/docs/Power-Monitoring-Calibration/</a></li>
</ul>
<h3 id="version-history">Version History:</h3>
<p><strong>Author:</strong> <a href="mailto:blackfeather@runestone.tech">blackfeather@runestone.tech</a>
<strong>Version:</strong> 1.02
<strong>Last Updated:</strong> 3-22-2024</p>

  
  <hr>
<div class="footer">
    
    
    
    <p>
    This is a post in the <b><a href="/series/home-assistant">home assistant</a></b> series.
        <br>Other posts in this series:
        <ul class="series">
            
            
            
            <li>
                March 22, 2023 -
                
                    SwitchBot Mini Smart Plugs with Tasmota &#43; Home Assistant
                
            </li>
            
        </ul>
    </p>
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#procedures">Procedures:</a>
      <ul>
        <li><a href="#initialize-switchbot-plug">Initialize SwitchBot Plug:</a></li>
        <li><a href="#setup-switchbota-web-server">Setup SwitchbOTA Web Server:</a></li>
        <li><a href="#configure-dns">Configure DNS:</a></li>
        <li><a href="#flash-tasmota">Flash Tasmota:</a></li>
        <li><a href="#configure-tasmota">Configure Tasmota</a></li>
        <li><a href="#power-calibration">Power Calibration</a></li>
        <li><a href="#add-to-home-assistant">Add to Home Assistant</a></li>
      </ul>
    </li>
    <li><a href="#final-words">Final Words</a></li>
    <li><a href="#references--resources">References &amp; Resources:</a>
      <ul>
        <li><a href="#version-history">Version History:</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
